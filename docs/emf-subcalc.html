
    <html lang="en">
    	<head>
    		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    		<title>emf.subcalc</title>
            <link href="https://fonts.googleapis.com/css?family=Anonymous+Pro|Open+Sans" rel="stylesheet">
            <link rel="stylesheet" type="text/css" href="style.css">
    	</head>
        <body onresize="mainWidth()">

            <!--Navigation Bar-->
            <div id="nav"><h2>Contents</h2><ul id="nav-ul">   <li class="nav-li"><a href="#functions">functions</a>    <ul class="subnav-ul"><li class="subnav-li"><a href="#close">close</a></li><li class="subnav-li"><a href="#convert_REF">convert_REF</a></li><li class="subnav-li"><a href="#drop_footprint_template">drop_footprint_template</a></li><li class="subnav-li"><a href="#ion">ion</a></li><li class="subnav-li"><a href="#load_model">load_model</a></li><li class="subnav-li"><a href="#plot_contour">plot_contour</a></li><li class="subnav-li"><a href="#plot_pcolormesh">plot_pcolormesh</a></li><li class="subnav-li"><a href="#read_REF">read_REF</a></li><li class="subnav-li"><a href="#show">show</a></li></ul>   <li class="nav-li"><a href="#classes">classes</a>    <ul class="subnav-ul"><li class="subnav-li"><a href="#Footprint">Footprint</a></li><li class="subnav-li"><a href="#Model">Model</a></li></ul></ul></div>

            <div id="main">
                <h1>emf.subcalc</h1>

                <!--classes section-->
                <div class="section" id="classes"><h2>Classes</h2><div class="class" id="Footprint"><h3>Footprint</h3><div class="function" ><p class="function-str">Footprint(name, x, y, power_line, of_concern, draw_as_loop, group)</p><p class="docstr">args:<br>&ensp;&ensp;&ensp;name - string, the name of the Footprint, i.e. "Substation"<br>&ensp;&ensp;&ensp;x - iterable, x coordinates of Footprint<br>&ensp;&ensp;&ensp;y - iterable, y coordinates of Footprint<br>&ensp;&ensp;&ensp;power_line - bool, True indicates the footprint corresponds to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;modeled<br>&ensp;&ensp;&ensp;of_concern - bool, True if the Footprint represents an area<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;that is potentially concerned about EMF (homes)<br>&ensp;&ensp;&ensp;draw_as_loop - bool, True if the footprint should be plotted<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;as a closed loop<br>&ensp;&ensp;&ensp;group - string, group strings that are identical between<br>&ensp;&ensp;&ensp;&ensp;&ensp;Footprint objects designate them as part of the same<br>&ensp;&ensp;&ensp;&ensp;&ensp;group for plotting</p></div><div class="properties"><h4>Properties</h4><div class="property"><p class="prop-name">group</p><p class="docstr">Group name</p></div><div class="property"><p class="prop-name">x</p><p class="docstr">x coordinates of Footprint vertices</p></div><div class="property"><p class="prop-name">y</p><p class="docstr">y coordinates of Footprint vertices</p></div></div></div><div class="class" id="Model"><h3>Model</h3><p class="docstr">Model objects store the results of magnetic field modeling generated by the SubCalc program. A Model can be created by passing grid results directly or by passing a dictionary of grid results. The function subcalc.load_model is the best way to generate a Model object from a .REF file containing SubCalc results. The Model object can be saved to a more flexible (and smaller) excel file with Model.export(). Then the excel file can be read back into a Model object using subcalc.load_model, but targeting the excel file.<br><br>&ensp;Model objects have a 'Bkey' property that determines which component of the magnetic field results is accessed by the Model.B property. For example, when Model.Bkey == 'Bmax' all operations involving the grid of magnetic field results accessed by Model.B will operate on the 'max' field component. When Bmax == 'Bz' all operations deal with the vertical 'z' component of the field, and so on. This includes plotting.<br><br>&ensp;Footprints of objects in the Model domain like buildings, the power lines, fences, etc. can also be stored in Model objects. Data for these objects must be saved in csv template files. The path of the footprint csv files can be passed to subcalc.load_model for automatic inclusion in a newly generated Model object or it can be passed to an existing Model with Model.load_footprints. The footprint data is stored in Footprint objects that have very little functionality and are mostly just organizational objects.<br><br>&ensp;Several methods are available for interpolating new values from the grid of field results: Model.interp, Model.resample, and Model.cross_section.<br><br>&ensp;Contour plots of the results can be automatically generated with subcalc.plot_contour(Model) and colormesh plots can be automatically generated with subcalc.plot_pcolormesh(Model).</p><div class="function" ><p class="function-str">Model(*args, **kw)</p><p class="docstr">Grid data must be passed in<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;either:<br>&ensp;&ensp;&ensp;&ensp;X - 2D array of x coordinates<br>&ensp;&ensp;&ensp;&ensp;Y - 2D array of y coordinats<br>&ensp;&ensp;&ensp;&ensp;B - 2D array of magnetic field magnitudes<br>&ensp;&ensp;&ensp;&ensp;info - dict, optional, dictionary of model metadata<br>&ensp;&ensp;&ensp;or:<br>&ensp;&ensp;&ensp;&ensp;data - dict, dictionary with X, Y, and B grids, should be<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;keyed by 'X','Y','Bmax','Bres','Bx','By','Bz'<br>&ensp;&ensp;&ensp;&ensp;info - dict, optional, dictionary of model metadata<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;Bkey - str, selects which component of field results to use<br>&ensp;&ensp;&ensp;&ensp;&ensp;or defines which component is passed as grid arrays<br>&ensp;&ensp;&ensp;&ensp;&ensp;('Bmax', 'Bres', 'Bx', 'By', 'Bz').</p></div><div class="properties"><h4>Properties</h4><div class="property"><p class="prop-name">B</p><p class="docstr">2D grid of magnetic field results</p></div><div class="property"><p class="prop-name">Bkey</p><p class="docstr">Component of magnetic field accessed by the B property</p></div><div class="property"><p class="prop-name">X</p><p class="docstr">2D grid of reference grid x coordinates</p></div><div class="property"><p class="prop-name">Y</p><p class="docstr">2D grid of reference grid y coordinates</p></div><div class="property"><p class="prop-name">footprint_groups</p><p class="docstr">Generate a list of lists of Footprints with identical tags</p></div><div class="property"><p class="prop-name">north_angle</p><p class="docstr">Angle of the Northern direction in degrees, where 0 represents<br>&ensp;&ensp;&ensp;the vertical or Y direction and clockwise represents increasing<br>&ensp;&ensp;&ensp;angle</p></div><div class="property"><p class="prop-name">x</p><p class="docstr">Unique x values in model grid (column positions)</p></div><div class="property"><p class="prop-name">xmax</p></div><div class="property"><p class="prop-name">xmin</p></div><div class="property"><p class="prop-name">y</p><p class="docstr">Unique y values in model grid (row positions)</p></div><div class="property"><p class="prop-name">ymax</p></div><div class="property"><p class="prop-name">ymin</p></div></div><div class="methods"><h4>Methods</h4><div class="function" id="cross_section"><p class="function-str">cross_section(p1, p2, **kw)</p><p class="docstr">Interpolate the field along a line between two points<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;p1 - iterable, an x-y pair<br>&ensp;&ensp;&ensp;p2 - iterable, an x-y pair<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;n - integer, number of points sampled (default 1000)<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;x - array, x coordinates of interpolated values<br>&ensp;&ensp;&ensp;y - array, y coordinates of interpolated values<br>&ensp;&ensp;&ensp;B_interp - array, interpolated field values</p></div><div class="function" id="export"><p class="function-str">export(**kw)</p><p class="docstr">Export the grid data and accompanying info to an excel file with<br>&ensp;&ensp;tabs for each Bfield component, another for the info dict, and a<br>&ensp;&ensp;final one for footprints if they're present<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;path - string, output destination/filename for workbook</p></div><div class="function" id="flatten"><p class="function-str">flatten()</p><p class="docstr">Create 1 dimensional versions of the gridded X, Y, and B arrays<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;x - 1D numpy array with x coordinates<br>&ensp;&ensp;&ensp;y - 1D numpy array with y coordinates<br>&ensp;&ensp;&ensp;b - 1D numpy array with magnetic field values</p></div><div class="function" id="in_grid"><p class="function-str">in_grid(x, y)</p><p class="docstr">Check if an x,y coordinate pair is inside the Model grid<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;x - float, x coordinate<br>&ensp;&ensp;&ensp;y - float, y coordinate<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;b - bool, True if x,y is in the grid, False if it's not</p></div><div class="function" id="interp"><p class="function-str">interp(x, y)</p><p class="docstr">Interpolate in the x and y directions to find an estimated B<br>&ensp;&ensp;value at an x,y location within the model<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;x - iterable or scalar, x coordinate(s) to interpolate at<br>&ensp;&ensp;&ensp;y - iterable or scalar, y coordinate(s) to interpolate at<br>&ensp;&ensp;return:<br>&ensp;&ensp;&ensp;B_interp - array or float, the interpolated field value</p></div><div class="function" id="load_footprints"><p class="function-str">load_footprints(footprint_info, **kw)</p><p class="docstr">Read footprint data from a csv file and organize it in<br>&ensp;&ensp;Footprint objects stored in self.footprints<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;footprint_info - string, path to the footprint csv/excel data.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;If footprint data is in an excel workbook with,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;multiple sheets, the sheet name must be passed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;to the kwarg 'sheet'<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;or<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;an existing DataFrame with footprint data</p></div><div class="function" id="resample"><p class="function-str">resample(**kw)</p><p class="docstr">Resample the model grid along a new number of x,y values, a new<br>&ensp;&ensp;selection of x,y values, or a new number of total values<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;x - int or iterable, new number of x samples or new selection of<br>&ensp;&ensp;&ensp;&ensp;x samples<br>&ensp;&ensp;&ensp;y - int or iterable, new number of y samples or new selection of<br>&ensp;&ensp;&ensp;&ensp;y samples<br>&ensp;&ensp;&ensp;N - int, new approximate number of total samples<br>&ensp;&ensp;&ensp;&ensp;&ensp;- overrides x and y kw<br>&ensp;&ensp;&ensp;&ensp;&ensp;- preserves approx ratio of number of x and y values<br>&ensp;&ensp;&ensp;&ensp;&ensp;- rounds up to nearest possible whole number of points<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;mod_resample - a new Model object containing the resampled grid</p></div></div></div></div>

                <!--functions section-->
                <div class="section" id="functions"><h2>Functions</h2><div class="function" id="close"><p class="function-str">close(*args)</p><p class="docstr">Call plt.close() on any Figure objects or lists of Figure objects<br>&ensp;passed in. If nothing is passed, all Figure objects are closed with<br>&ensp;plt.close('all')</p></div><div class="function" id="convert_REF"><p class="function-str">convert_REF(*args, **kw)</p><p class="docstr">Convert a .REF model file to an excel file storing the same data and<br>&ensp;save the excel file<br>&ensp;args:<br>&ensp;&ensp;REF_path - string, path to the .REF file<br>&ensp;&ensp;footprint_path - string, optional, path to footprint csv file<br>&ensp;kw:<br>&ensp;&ensp;path - string, path/name of output file</p></div><div class="function" id="drop_footprint_template"><p class="function-str">drop_footprint_template(*args, **kw)</p><p class="docstr">Copy the emf.fields template in the current directory or a<br>&ensp;directory specified by an input string<br>&ensp;args:<br>&ensp;&ensp;drop_path = string, path of copied template file</p></div><div class="function" id="ion"><p class="function-str">ion()</p><p class="docstr">Call plt.ion() to toggle interactive plotting on</p></div><div class="function" id="load_model"><p class="function-str">load_model(*args, **kw)</p><p class="docstr">Read a .REF output file and load the data into a Model object<br>&ensp;args:<br>&ensp;&ensp;results_path - string, path to the output .REF file of field results or to<br>&ensp;&ensp;&ensp;&ensp;the excel file exported by a Model object<br>&ensp;&ensp;footprint_path - string, optional, path to the csv file of<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; footprint data<br>&ensp;kw:<br>&ensp;&ensp;Bkey - string, sets 'component' of magnetic field results that the<br>&ensp;&ensp;&ensp;   returned Model object accesses by default<br>&ensp;&ensp;&ensp;&ensp;&ensp; - can be 'Bx', 'By', 'Bz', 'Bmax', or 'Bres'<br>&ensp;&ensp;&ensp;&ensp;&ensp; - default is 'Bmax'<br>&ensp;&ensp;&ensp;&ensp;&ensp; - all components are stored, none are lost<br>&ensp;returns<br>&ensp;&ensp;mod - Model object containing results</p></div><div class="function" id="plot_contour"><p class="function-str">plot_contour(mod, **kw)</p><p class="docstr">Generate a contour plot from the magnetic field results and<br>&ensp;Footprint objects stored in a Model object<br>&ensp;args:<br>&ensp;&ensp;mod - Model object<br>&ensp;kw:<br>&ensp;&ensp;scale - str, can be 'log' or 'linear' (default is 'linear')<br>&ensp;&ensp;levels - iterable, determines contour level values<br>&ensp;&ensp;&ensp;&ensp;&ensp;(automatically determined by matplotlib if not used)<br>&ensp;&ensp;north_angle - number, direction of north arrow<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;(0 is along +y axis and clockwise is increasing)<br>&ensp;&ensp;cmap - str, name of matplotlib colormap, see:<br>&ensp;&ensp;&ensp;&ensp;http://matplotlib.org/examples/color/colormaps_reference.html<br>&ensp;&ensp;save - bool, toggle whether the figure is saved<br>&ensp;&ensp;path - string, path to directory for saved figure. If set, overrides<br>&ensp;&ensp;&ensp;&ensp;the 'save' keyword<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;max_fig_width - float/int, inches, maximum width of figure<br>&ensp;&ensp;max_fig_height - float/int, inches, maximum height of figure<br>&ensp;&ensp;legend_padding - float/int, inches, width left for legend area<br>&ensp;returns:<br>&ensp;&ensp;fig - matplotlib figure object<br>&ensp;&ensp;ax - matplotlib axes object<br>&ensp;&ensp;CS - matplotlib QuadContourSet object</p></div><div class="function" id="plot_pcolormesh"><p class="function-str">plot_pcolormesh(mod, **kw)</p><p class="docstr">Generate a color mesh plot of the magnetic field results and<br>&ensp;Footprint objects stored in a Model object<br>&ensp;args:<br>&ensp;&ensp;mod - Model object<br>&ensp;kw:<br>&ensp;&ensp;north_angle - number, direction of north arrow<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;(0 is along +y axis and clockwise is increasing)<br>&ensp;&ensp;cmap - str, name of matplotlib colormap, see:<br>&ensp;&ensp;&ensp;&ensp;http://matplotlib.org/examples/color/colormaps_reference.html<br>&ensp;&ensp;save - bool, toggle whether the figure is saved<br>&ensp;&ensp;path - string, path to directory for saved figure. If set, overrides<br>&ensp;&ensp;&ensp;&ensp;the 'save' keyword<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;max_fig_width - float/int, inches, maximum width of figure<br>&ensp;&ensp;max_fig_height - float/int, inches, maximum height of figure<br>&ensp;&ensp;legend_padding - float/int, inches, width left for legend area<br>&ensp;returns:<br>&ensp;&ensp;fig - matplotlib figure object<br>&ensp;&ensp;ax - matplotlib axes object<br>&ensp;&ensp;QM - matplotlib QuadMesh object<br>&ensp;&ensp;cbar - matplotlib Axes that the colorbar is drawn in (to which<br>&ensp;&ensp;&ensp;&ensp;legend is attached)</p></div><div class="function" id="read_REF"><p class="function-str">read_REF(file_path)</p><p class="docstr">Reads a .REF output file generated by the SUBCALC program and pulls<br>&ensp;out information about the reference grid of the model with the Res and<br>&ensp;Max magnetic fields.<br>&ensp;args:<br>&ensp;&ensp;file_path - string, path to saved .REF output file<br>&ensp;returns:<br>&ensp;&ensp;data - dict, keys are 'x', 'y', 'Bmax', 'Bres', 'Bx', 'By', and 'Bz'<br>&ensp;&ensp;info - dict, reference grid and other information</p></div><div class="function" id="show"><p class="function-str">show()</p><p class="docstr">Call plt.show() to display open figures</p></div></div>
            </div>

        </body>

        <!--Control the width and height of the #main element-->
        <script type="text/javascript">

            function mainWidth(){
                var w_nav = document.getElementById('nav').offsetWidth;
                var w_body = document.body.offsetWidth;
                var w = (w_body - w_nav - 3).toString() + 'px';
                document.getElementById('main').style.width = w;}

            function navHeight(){
                var h = document.getElementById('main').offsetHeight;
                console.log(h);
                document.getElementById('nav').style.height = h;}

            document.addEventListener("load", mainWidth());
            document.addEventListener("load", navHeight());
            document.addEventListener("resize", mainWidth());
            document.addEventListener("resize", navHeight());

        </script>

    </html>
