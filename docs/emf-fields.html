
    <html lang="en">
    	<head>
    		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    		<title>emf.fields</title>
            <link href="https://fonts.googleapis.com/css?family=Anonymous+Pro|Open+Sans" rel="stylesheet">
            <link rel="stylesheet" type="text/css" href="style.css">
    	</head>
        <body onresize="mainWidth()">

            <!--Navigation Bar-->
            <div id="nav"><h2>Contents</h2><ul id="nav-ul">   <li class="nav-li"><a href="#functions">functions</a>    <ul class="subnav-ul"><li class="subnav-li"><a href="#B_field">B_field</a></li><li class="subnav-li"><a href="#E_field">E_field</a></li><li class="subnav-li"><a href="#close">close</a></li><li class="subnav-li"><a href="#convert_DAT">convert_DAT</a></li><li class="subnav-li"><a href="#convert_DAT_crawl">convert_DAT_crawl</a></li><li class="subnav-li"><a href="#drop_template">drop_template</a></li><li class="subnav-li"><a href="#ion">ion</a></li><li class="subnav-li"><a href="#load_template">load_template</a></li><li class="subnav-li"><a href="#optimize_phasing">optimize_phasing</a></li><li class="subnav-li"><a href="#phasors_to_magnitudes">phasors_to_magnitudes</a></li><li class="subnav-li"><a href="#plot_Bmax">plot_Bmax</a></li><li class="subnav-li"><a href="#plot_Emax">plot_Emax</a></li><li class="subnav-li"><a href="#plot_groups">plot_groups</a></li><li class="subnav-li"><a href="#plot_groups_at_ROW">plot_groups_at_ROW</a></li><li class="subnav-li"><a href="#plot_max_fields">plot_max_fields</a></li><li class="subnav-li"><a href="#plot_xs">plot_xs</a></li><li class="subnav-li"><a href="#read_DAT">read_DAT</a></li><li class="subnav-li"><a href="#run">run</a></li><li class="subnav-li"><a href="#show">show</a></li><li class="subnav-li"><a href="#target_fields">target_fields</a></li><li class="subnav-li"><a href="#to_FLD">to_FLD</a></li><li class="subnav-li"><a href="#to_FLDs">to_FLDs</a></li><li class="subnav-li"><a href="#to_FLDs_crawl">to_FLDs_crawl</a></li></ul>   <li class="nav-li"><a href="#classes">classes</a>    <ul class="subnav-ul"><li class="subnav-li"><a href="#Conductor">Conductor</a></li><li class="subnav-li"><a href="#CrossSection">CrossSection</a></li><li class="subnav-li"><a href="#SectionBook">SectionBook</a></li></ul></ul></div>

            <div id="main">
                <h1>emf.fields</h1>

                <!--classes section-->
                <div class="section" id="classes"><h2>Classes</h2><div class="class" id="Conductor"><h3>Conductor</h3><p class="docstr">Class representing a single conductor or power line.</p><div class="function" ><p class="function-str">Conductor(*args)</p><p class="docstr">args:<br>&ensp;&ensp;&ensp;tag - scalar hashable, mandatory, essentially just a name<br>&ensp;&ensp;&ensp;params - dict or list, available Conductor parameters are:<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;'x', 'y', 'subconds', 'd_cond', 'd_bund', 'V', 'I', 'phase'<br><br>&ensp;&ensp;&ensp;&ensp;A list can be passed with the values of any number of those paremeters (in the order listed above) or a dict can be passed with any number of those parameter strings as keys.<br>&ensp;&ensp;&ensp;cond - an existing Conductor object, parameters that are not set with the second arg will be borrowed from the Conductor</p></div><div class="properties"><h4>Properties</h4><div class="property"><p class="prop-name">I</p></div><div class="property"><p class="prop-name">V</p></div><div class="property"><p class="prop-name">complete</p><p class="docstr">Check if all Conductor variables have been set</p></div><div class="property"><p class="prop-name">d_bund</p></div><div class="property"><p class="prop-name">d_cond</p></div><div class="property"><p class="prop-name">freq</p></div><div class="property"><p class="prop-name">phase</p></div><div class="property"><p class="prop-name">subconds</p></div><div class="property"><p class="prop-name">tag</p></div><div class="property"><p class="prop-name">x</p></div><div class="property"><p class="prop-name">y</p></div></div><div class="methods"><h4>Methods</h4><div class="function" id="copy"><p class="function-str">copy()</p></div></div></div><div class="class" id="CrossSection"><h3>CrossSection</h3><p class="docstr">Class that organizes Conductor objects and stores other input information for a power line cross section. Includes plotting methods for the fields results and exporting methods for the results.</p><div class="function" ><p class="function-str">CrossSection(sheet, *args)</p><p class="docstr">CrossSection must be initialized with a sheet string, and a list of Conductor objects can optionally be passed in in the second arg<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;sheet - string, the name of the CrossSection<br>&ensp;&ensp;&ensp;conds - list of Conducor objects to copy into the xs</p></div><div class="properties"><h4>Properties</h4><div class="property"><p class="prop-name">I</p></div><div class="property"><p class="prop-name">ROW_edge_fields</p></div><div class="property"><p class="prop-name">V</p></div><div class="property"><p class="prop-name">complete</p><p class="docstr">Check that all variables in each conductor in the CrossSection are set, and not left with the initial None values.<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;b - True if all Conductors are complete, False if not<br>&ensp;&ensp;&ensp;t - tag of first incomplete Conductor, if any, else None<br>&ensp;&ensp;&ensp;v - variable name of first unset variable in first incomplete&ensp;   Conductor, if any, else None</p></div><div class="property"><p class="prop-name">d_bund</p></div><div class="property"><p class="prop-name">d_cond</p></div><div class="property"><p class="prop-name">fields</p></div><div class="property"><p class="prop-name">freq</p></div><div class="property"><p class="prop-name">gnd</p></div><div class="property"><p class="prop-name">hot</p></div><div class="property"><p class="prop-name">lROW</p></div><div class="property"><p class="prop-name">max_dist</p></div><div class="property"><p class="prop-name">phase</p></div><div class="property"><p class="prop-name">rROW</p></div><div class="property"><p class="prop-name">sample_height</p></div><div class="property"><p class="prop-name">sheet</p></div><div class="property"><p class="prop-name">step</p></div><div class="property"><p class="prop-name">subconds</p></div><div class="property"><p class="prop-name">tags</p></div><div class="property"><p class="prop-name">x</p></div><div class="property"><p class="prop-name">x_sample</p></div><div class="property"><p class="prop-name">y</p></div><div class="property"><p class="prop-name">y_sample</p></div></div><div class="methods"><h4>Methods</h4><div class="function" id="add_conductor"><p class="function-str">add_conductor(cond)</p><p class="docstr">Add a Conductor object to the CrossSection<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;cond - Conductor object to add</p></div><div class="function" id="compare_DAT"><p class="function-str">compare_DAT(DAT_path, **kw)</p><p class="docstr">Load a FIELDS output file (.DAT), find absolute and percentage differences between it and the CrossSection object's results.<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;DAT_path - path of FIELDS results file<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;save - boolean, toggle whether output Panel and figures are saved, also saves figures with error and comparison plots<br>&ensp;&ensp;&ensp;path - string, destination of saved files, will force save == True<br>&ensp;&ensp;&ensp;round - int, round the results in self.fields to a certain number   of digits in an attempt to exactly match the FIELDS results, which are printed only to the thousandths digit<br>&ensp;&ensp;&ensp;truncate - bool, truncate results after the thousandths digit<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;pan - pandas Panel with DAT results, results of this code, the absolute error between, and the relative error between</p></div><div class="function" id="copy"><p class="function-str">copy()</p></div><div class="function" id="export"><p class="function-str">export(**kw)</p><p class="docstr">Write the fields to a csv<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;path - string, destination/filename for saved file</p></div><div class="function" id="remove_conductor"><p class="function-str">remove_conductor(key)</p><p class="docstr">Remove a Conductor object from the CrossSection<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;key - Conductor tag or Conductor object to remove</p></div><div class="function" id="sample"><p class="function-str">sample(*args)</p><p class="docstr">Get a random Conductor from the CrossSection<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;an input integer determines the number of random xss fetched</p></div></div></div><div class="class" id="SectionBook"><h3>SectionBook</h3><p class="docstr">Top level class organizing a group of CrossSection objects. Uses a dictionary to track CrossSections in a list and provide a convenient __getitem__ method than gets CrossSections by their name. Also tracks maximum field results at the ROW edges of each CrossSection added, provides a plotting method for CrossSection groups, and provides exporting methods.</p><div class="function" ><p class="function-str">SectionBook(name, *args)</p><p class="docstr">SectionBooks must be initialized with a name string, with the option to pass a list of CrossSection objects in the second arg<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;name - string, name of SectionBook<br>&ensp;&ensp;&ensp;xs - list of CrossSection objects to copy into the SectionBook</p></div><div class="properties"><h4>Properties</h4><div class="property"><p class="prop-name">ROW_edge_max</p><p class="docstr">DataFrame with maximum field magnitudes for each CrossSection</p></div><div class="property"><p class="prop-name">complete</p><p class="docstr">Check that all CrossSections in the SectionBook are complete<br>&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;b - True if all xcs are complete, False if not<br>&ensp;&ensp;&ensp;sheet - sheet of first incomplete xs, if any, else None<br>&ensp;&ensp;&ensp;ctag - tag of first incomplete Conductor in first incomplete xs, if any, else None<br>&ensp;&ensp;&ensp;v - variable name of first unset variable in first incomplete Conductor in first incomplete xs, if any, else None</p></div><div class="property"><p class="prop-name">sheets</p><p class="docstr">list of CrossSection sheets</p></div><div class="property"><p class="prop-name">tag_groups</p><p class="docstr">a list of lists of grouped CrossSection objects</p></div><div class="property"><p class="prop-name">tags</p><p class="docstr">set of CrossSection tags</p></div></div><div class="methods"><h4>Methods</h4><div class="function" id="ROW_edge_export"><p class="function-str">ROW_edge_export(**kw)</p><p class="docstr">Write max field results at ROW edges for each cross section to an excel or csv file. Default is csv.<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;file_type - string, accepts 'csv' or 'excel' (default csv)<br>&ensp;&ensp;&ensp;path - string, destination/filename for saved file<br>&ensp;&ensp;&ensp;xl - pandas ExcelWriter object, takes precedence over 'path'</p></div><div class="function" id="add_section"><p class="function-str">add_section(xs, **kw)</p><p class="docstr">Add a CrossSection to the book. Doing so by directly altering self.xss will make the CrossSections inaccessible by __getitem__ and make the group plotting functions impossible, so don't do that. Use this method instead.<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;xs - CrossSection object to add to SectionBook (a copy is added)<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;sheet - a new sheet name for the added CrossSection</p></div><div class="function" id="export"><p class="function-str">export(**kw)</p><p class="docstr">Write results to an excel workbook and ROW edge results to a csv<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;path - string, destination/filename for saved file</p></div><div class="function" id="remove_section"><p class="function-str">remove_section(sheet)</p><p class="docstr">Remove a CrossSection from the SectionBook by providing its sheet string<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;sheet - sheet string of CrossSection to remove</p></div><div class="function" id="results_export"><p class="function-str">results_export(**kw)</p><p class="docstr">Write all of the cross section results to an excel workbook<br>&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;path - string, destination/filename for saved file</p></div><div class="function" id="sample"><p class="function-str">sample(*args)</p><p class="docstr">Get a random CrossSection from the SectionBook<br>&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;an input integer determines the number of random xss fetched</p></div></div></div></div>

                <!--functions section-->
                <div class="section" id="functions"><h2>Functions</h2><div class="function" id="B_field"><p class="function-str">B_field(x_cond, y_cond, I_cond, p_cond, x, y)</p><p class="docstr">Calculate the approximate magnetic field generated by a group of conductors. Each of the variables with '_cond' should be an numpy array of parameters, where each index in those arrays describes a unique conductor, i.e. the 0th value in each variable is attributed to one power line.<br>&ensp;args:<br>&ensp;&ensp;x_cond - 1D numpy array, horizontal coordinates of conductors (ft)<br>&ensp;&ensp;y_cond - 1D numpy array, vertical coordinates of conductors (ft)<br>&ensp;&ensp;I_cond - 1D numpy array, currents of conductors (Amps)<br>&ensp;&ensp;p_cond - 1D numpy array, phases of conductors (degrees)<br>&ensp;&ensp;x - iterable of floats, horizontal coordinates of sample points (ft)<br>&ensp;&ensp;y - iterable of floats, vertical coordinates of sample points (ft)<br>&ensp;returns:<br>&ensp;&ensp;Bx - 1D numpy array of complex numbers, magnitic field phasors in<br>&ensp;&ensp;&ensp;&ensp;the horizontal direction (mG)<br>&ensp;&ensp;By - 1D numpy array of complex numbers, magnitic field phasors in<br>&ensp;&ensp;&ensp;&ensp;the vertical direction (mG)</p></div><div class="function" id="E_field"><p class="function-str">E_field(x_cond, y_cond, subconds, d_cond, d_bund, V_cond, p_cond, x, y)</p><p class="docstr">Calculate the approximate electric field generated by a group of conductors. Each of the inputs with '_cond' in their name should be an numpy array of parameters, where each index in those arrays describes a unique conductor, i.e. the 0th value in each variable is attributed to one power line.<br>&ensp;&ensp;x_cond - 1D numpy array, horizontal coordinates of conductors (ft)<br>&ensp;&ensp;y_cond - 1D numpy array, vertical coordinates of conductors (ft)<br>&ensp;&ensp;subconds - 1D numpy array, number of subconductors per bundle<br>&ensp;&ensp;d_cond - 1D numpy array, conductor diameters (inches)<br>&ensp;&ensp;d_bund - 1D numpy array, bundle diameters (inches)<br>&ensp;&ensp;V_cond - 1D numpy array, voltages of conductors (Amps)<br>&ensp;&ensp;p_cond - 1D numpy array, phases of conductors (degrees)<br>&ensp;&ensp;x - iterable of floats, horizontal coordinates of sample points (ft)<br>&ensp;&ensp;y - iterable of floats, vertical coordinates of sample points (ft)<br>&ensp;returns:<br>&ensp;&ensp;Ex - 1D numpy array of complex numbers, electric field phasors in<br>&ensp;&ensp;&ensp;&ensp;the horizontal direction (mG)<br>&ensp;&ensp;Ey - 1D numpy array of complex numbers, electric field phasors in<br>&ensp;&ensp;&ensp;&ensp;the vertical direction (mG)</p></div><div class="function" id="close"><p class="function-str">close(*args)</p><p class="docstr">Call plt.close() on any Figure objects or lists of Figure objects passed in. If nothing is passed, all Figure objects are closed with plt.close('all')</p></div><div class="function" id="convert_DAT"><p class="function-str">convert_DAT(file_path, **kw)</p><p class="docstr">read a DAT file and write it to a csv<br>&ensp;args:<br>&ensp;&ensp;file_path - target DAT file<br>&ensp;kw:<br>&ensp;&ensp;path - output location/name for csv file</p></div><div class="function" id="convert_DAT_crawl"><p class="function-str">convert_DAT_crawl(dir_name, **kw)</p><p class="docstr">crawl a directory and all of its subdirectories for .DAT files that can be passed to DAT_to_csv() for output re-formatting and optional plotting.<br>&ensp;args:<br>&ensp;&ensp;dir_name - the directory to initiate the crawl in. To designate the current directory, use '*'<br>&ensp;kw:<br>&ensp;&ensp;bundle - bool, if True, all DAT files found in the same directory are written to a common excel workbook. If False or absent, the DAT files are simply written to csv files.</p></div><div class="function" id="drop_template"><p class="function-str">drop_template(*args, **kw)</p><p class="docstr">Copy the emf.fields template in the current directory or a directory specified by an input string<br>&ensp;args:<br>&ensp;&ensp;drop_path = string, path of copied template file</p></div><div class="function" id="ion"><p class="function-str">ion()</p><p class="docstr">Call plt.ion() to toggle interactive plotting on</p></div><div class="function" id="load_template"><p class="function-str">load_template(file_path, **kw)</p><p class="docstr">Import conductor data from an excel template, loading each conductor into a Conductor object, each Conductor into a CrossSection object, and each CrossSection object into a SectionBook object. The SectionBook object is returned.<br>&ensp;args:<br>&ensp;&ensp;template_path - string, path to cross section template excel<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;workbook<br>&ensp;kw:<br>&ensp;&ensp;sheets - list of strings, a list of sheet names to load, default is<br>&ensp;&ensp;&ensp;&ensp; all sheets</p></div><div class="function" id="optimize_phasing"><p class="function-str">optimize_phasing(xs, circuits, **kw)</p><p class="docstr">Permute the phasing of non-grounded conductors and find the arrangement that results in the lowest fields at the left and right edge of the ROW. The number of hot conductors must be a multiple of three. The phases of consecutive groups of three conductors are swapped around, assuming that those groups represent a single three-phase transfer circuit.<br>&ensp;args:<br>&ensp;&ensp;xs - target CrossSection object<br>&ensp;&ensp;circuits - list of lists of Conductor tags, or 'all'. If a list of lists, each sublist contains the Conductor tags of the Conductors comprising a single circuit. If 'all', circuits are assumed to be consecutive groups of three conductors. (consecutive according to the order in which hot conductors were added to the CrossSection)<br>&ensp;kw:<br>&ensp;&ensp;save - bool, toggle saving of the results DataFrame to an excel book<br>&ensp;&ensp;path - string, location/filename for saved results workbook, forces saving even if no 'save' keyword is used.<br>&ensp;returns:<br>&ensp;&ensp;res - pandas DataFrame listing conductor phasings that optimize electric and magnetic fields at both ROW edges.<br>&ensp;&ensp;opt - new SectionBook object containing the permuted phasings that optimize the E and B fields at the left and right ROW edges.</p></div><div class="function" id="phasors_to_magnitudes"><p class="function-str">phasors_to_magnitudes(Ph_x, Ph_y)</p><p class="docstr">Convert vectors of complex x and y phasors into real quantities, namely the amplitude of the field in the x and y directions, the product (the hypotenuse of the amplitudes), and the maximum field.<br>&ensp;args:<br>&ensp;&ensp;Ph_x - complex 1D numpy array, phasor horizontal components<br>&ensp;&ensp;Ph_y - complex 1D numpy array, phasor vertical components<br>&ensp;returns:<br>&ensp;&ensp;mag_x - 1D numpy array, maximum horizontal field<br>&ensp;&ensp;mag_y - 1D numpy array, maximum vertical field<br>&ensp;&ensp;prod - 1D numpy array, sqrt(mag_x**2 + mag_y**2)<br>&ensp;&ensp;maximum - 1D numpy array, maximum field at any time</p></div><div class="function" id="plot_Bmax"><p class="function-str">plot_Bmax(xs, **kw)</p><p class="docstr">Plot the maximum magnetic field along the ROW with conductor locations shown in artificial coordinates.<br>&ensp;args:<br>&ensp;&ensp;xs - a CrossSection object<br>&ensp;kw:<br>&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;returns:<br>&ensp;&ensp;fig - Figure object<br>&ensp;&ensp;ax - Axes object</p></div><div class="function" id="plot_Emax"><p class="function-str">plot_Emax(xs, **kw)</p><p class="docstr">Plot the maximum electric field along the ROW with conductor locations shown in artificial coordinates.<br>&ensp;args:<br>&ensp;&ensp;xs - a CrossSection object<br>&ensp;kw:<br>&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;returns:<br>&ensp;&ensp;fig - Figure object</p></div><div class="function" id="plot_groups"><p class="function-str">plot_groups(sb, **kw)</p><p class="docstr">Plot the fields of grouped CrossSections in the same axis, a plot for both fields. Only plots groups of more than one CrossSection.<br>&ensp;args:<br>&ensp;&ensp;sb - SectionBook object to pull plotting groups from<br>&ensp;kw:<br>&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;xmax - cutoff distance from ROW center<br>&ensp;&ensp;B - bool, toggle magnetic field plots, default is True<br>&ensp;&ensp;E - bool, toggle electric field plots, default is True<br>&ensp;&ensp;groups - a list of group names to plot, default is all groups<br>&ensp;&ensp;return_figs - toggle whether a list of figure objects is returned instead of closing the figures to clear memory, default is False<br>&ensp;returns:<br>&ensp;&ensp;figs - dict of dicts, keys are 'E' and 'B', which are each keyed by group tags, leading to Figure objects</p></div><div class="function" id="plot_groups_at_ROW"><p class="function-str">plot_groups_at_ROW(sb, **kw)</p><p class="docstr">Create bar charts showing the field values at ROW edges for each CrossSection group in a SectionBook<br>&ensp;args:<br>&ensp;&ensp;sb - SectionBook object to pull plotting groups from<br>&ensp;kw:<br>&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;B - bool, toggle magnetic field plots, default is True<br>&ensp;&ensp;E - bool, toggle electric field plots, default is True<br>&ensp;&ensp;groups - a list of group names to plot, default is all groups<br>&ensp;&ensp;xs_order - dict, keys are CrossSection group tags, which map to lists of CrossSection sheets specifying the order of the plotted CrossSection bars (left to right). Not all CrossSecitons in a group must be listed. Any/all can be left out.<br>&ensp;&ensp;return_figs - toggle whether a list of figure objects is returned instead of closing the figures to clear memory, default is False<br>&ensp;returns:<br>&ensp;&ensp;figs - dict of dicts, keys are 'E' and 'B', which are each keyed by group tags, leading to Figure objects</p></div><div class="function" id="plot_max_fields"><p class="function-str">plot_max_fields(xs, **kw)</p><p class="docstr">Plot the maximum magnetic and electric field on split vertical axes, along the ROW with conductor locations shown in artificial coordinates.<br>&ensp;args:<br>&ensp;&ensp;xs - a CrossSection object<br>&ensp;kw:<br>&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;title - string, exact plot title<br>&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;returns:<br>&ensp;&ensp;fig - Figure object<br>&ensp;&ensp;ax_B - B field Axes<br>&ensp;&ensp;ax_E - E field Axes</p></div><div class="function" id="plot_xs"><p class="function-str">plot_xs(xs, **kw)</p><p class="docstr">Plot CrossSection conductors and ROW edges without any fields<br>&ensp;args:<br>&ensp;&ensp;xs - CrossSection objects<br>&ensp;kw:<br>&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;format - string, saved plot format/extension (default 'png')</p></div><div class="function" id="read_DAT"><p class="function-str">read_DAT(file_path)</p><p class="docstr">Read a DAT file, which can have some funky extra characters if the numbers are too large (percent signs)<br>&ensp;args:<br>&ensp;&ensp;file_path - string, path to DAT file<br>&ensp;returns:<br>&ensp;&ensp;pandas DataFrame with 'Bx','By','Bprod','Bmax','Ex','Ey','Eprod', and 'Emax' columns, and the distance ('x') in the index</p></div><div class="function" id="run"><p class="function-str">run(template_path, **kw)</p><p class="docstr">Import the templates in an excel file with the path 'template_path' then generate a workbook of all fields results and lots of plots. Use the 'path' keyword argument to specify a destination for the output, otherwise it will be saved to the template's directory. Returns a SectionBook object.<br>&ensp;args:<br>&ensp;&ensp;template_path - path to cross section template excel workbook<br>&ensp;kw:<br>&ensp;&ensp;sheets - a list of sheet names to load, default is all sheets<br>&ensp;&ensp;path - string, destination/filename for saved files<br>&ensp;&ensp;format - string, saved plot format (usually 'png' or 'pdf')<br>&ensp;&ensp;xmax - cutoff distance from ROW center in plots</p></div><div class="function" id="show"><p class="function-str">show()</p><p class="docstr">Call plt.show() to display open figures</p></div><div class="function" id="target_fields"><p class="function-str">target_fields(xs, tags, B_l, B_r, E_l, E_r, **kw)</p><p class="docstr">Increase conductor y coordinates until fields at ROW edges are below thresholds. All selected conductors are adjusted by the same amount. If any of the thresholds are empty or false, None is returned for their adjustment result.<br>&ensp;args:<br>&ensp;&ensp;xs - CrossSection object to perform adjustments on<br>&ensp;&ensp;tags - iterable of Conductor tags, identifying which ones to raise<br>&ensp;&ensp;B_l - magnetic field threshold at left ROW edge*<br>&ensp;&ensp;B_r - magnetic field threshold at right ROW edge*<br>&ensp;&ensp;E_l - electric field threshold at left ROW edge*<br>&ensp;&ensp;E_r - electric field threshold at right ROW edge*<br><br>&ensp;&ensp;&ensp;*an implicitly False input will ignore that field-edge combination, return None in the return variable 'h', and cause the returned SectionBook to omit that field-edge combo.<br><br>&ensp;kw:<br>&ensp;&ensp;max_iter - maximum number of _bisection iterations allowed default is 1e3<br>&ensp;&ensp;rel_err - tolerance threshold for relative error (e.g. 0.01 is 1 %) default is 1e-6.<br>&ensp;&ensp;hhigh - upper limit of the height adjustment, default is 1.0e6<br>&ensp;&ensp;save - toggle saving of the results DataFrame to an excel book<br>&ensp;&ensp;path - location/filename for saved results workbook, forces saving even if no 'save' keyword is used.<br>&ensp;returns:<br>&ensp;&ensp;h - height adjustments necessary for E and B fields at left and right ROW edges. The ordering is: (B_left, B_right, E_left, E_right)<br>&ensp;&ensp;adj - a new SectionBook object with the adjusted conductor heights for each scenario in a CrossSection</p></div><div class="function" id="to_FLD"><p class="function-str">to_FLD(xs, **kw)</p><p class="docstr">Create an FLD input file for FIELDS out of a CrossSection object<br>&ensp;args:<br>&ensp;&ensp;xs - CrossSection object<br>&ensp;kw:<br>&ensp;&ensp;path - output file destination</p></div><div class="function" id="to_FLDs"><p class="function-str">to_FLDs(*args, **kw)</p><p class="docstr">Load or recieve a template workbook of CrossSections and convert them all to FLD files<br>&ensp;args:<br>&ensp;&ensp;can either be a path string to a target template workbook or an<br>&ensp;&ensp;existing SectionBook object<br>&ensp;kw:<br>&ensp;&ensp;path - output destination for FLD files, default is the same directory as the template book if a path string is passed or the current directory if a SectionBook is passed.</p></div><div class="function" id="to_FLDs_crawl"><p class="function-str">to_FLDs_crawl(dir_name, **kw)</p><p class="docstr">crawl a directory and all of its subdirectories for excel workbooks that can be passed to create_FLDs(). The FLD files are generated in the same directory as the template book they come from.</p></div></div>
            </div>

        </body>

        <!--Control the width and height of the #main element-->
        <script type="text/javascript">

            function mainWidth(){
                var w_nav = document.getElementById('nav').offsetWidth;
                var w_body = document.body.offsetWidth;
                var w = (w_body - w_nav - 3).toString() + 'px';
                document.getElementById('main').style.width = w;}

            mainWidth();
            document.addEventListener("resize", mainWidth());

            h_main = document.getElementById('main').offsetHeight;
            document.getElementById('nav').style.height = h_main;

        </script>

    </html>
    