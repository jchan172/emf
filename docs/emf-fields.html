 <html lang="en">  <head>   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">   <title>emf.fields</title>   <link href="https://fonts.googleapis.com/css?family=Anonymous+Pro|Open+Sans" rel="stylesheet">   <style>body { color: #ABB2BF; background-color: #282C34; font-family: 'Anonymous Pro', monospace; margin: 0; padding: 0; overflow: scroll;}#nav { float: left; margin: 0; padding: 0.5cm; min-height: 100%; background-color: #20242C; border-right: 1px solid #505050;}#nav h2 { font-family: "Open Sans", sans-serif; font-weight: normal; font-size: 24pt; margin: 0.25cm 0;}#nav-ul { margin: 0; padding: 0; list-style-type: none;}.nav-li { font-family: "Open Sans", sans-serif; font-size: 18pt; margin: 0.5cm 0;}.nav-li a { text-decoration: none; color: #828997;}.subnav-ul { list-style-type: none; padding: 0.5 0 0.5 0.5cm;}.subnav-li { font-family: "Anonymous Pro", monospace; font-size: 13pt; margin: 0.15cm 0;}.subnav-li a { text-decoration: none; color: #828997;}.subsubnav-ul { list-style-type: none; padding: 0 0 0 0.5cm; margin: 0 0 0.4cm 0;}.subsubnav-li { font-family: "Open Sans", sans-serif; font-size: 11pt; margin: 0.15cm 0;}.subsubnav-li a { text-decoration: none; color: #828997;}.subsubsubnav-ul { list-style-type: none; padding: 0 0 0 0.5cm; margin: 0 0 0.3cm 0;}.subsubsubnav-li { font-family: "Anonymous Pro", monospace; font-size: 11pt; margin: 0.15cm 0;}.subsubsubnav-li a { text-decoration: none; color: #828997;}#nav a:hover { font-weight: 700; color: #ABB2BF; /*background-color: #282C34;*/}#main { float: right; min-height: 100%;}#main h1 { font-family: "Open Sans", sans-serif; font-weight: normal; font-size: 400%; text-align: center; margin: 1cm 0;}.section { margin: 1cm; padding: 5% 5% 5% 1cm; border: 1px solid #484848; border-radius: 12px;}.section h2 { font-weight: normal; font-size: 250%; font-family: "Open Sans", sans-serif; text-align: center; margin: 0 0 1cm 0;}.docstr { margin-left: 1cm; font-size: 90%; text-align: justify; line-height: 125%; color: #98C379;}.class { border-top: 1px solid #404040;}.class h3 { font-weight: normal; font-size: 200%; font-family: "Open Sans", sans-serif; padding: 0; margin: 1cm 0 0 0.5cm;}#classes .class { margin-top: 1cm;}.class .function { padding-left: 0.1cm; border-left: 1px solid #404040;}.properties { margin: 1cm 0; padding-left: 0.1cm; border-left: 1px solid #404040;}.properties h4 { font-weight: normal; font-family: "Open Sans", sans-serif; font-size: 150%;}.properties .property { margin-left: 1cm; padding-left: 0.1cm; border-left: 1px solid #383838;}.methods { margin: 1cm 0 0 0; padding-left: 0.1cm; border-left: 1px solid #404040;}.methods h4 {  font-weight: normal;  font-family: "Open Sans", sans-serif;  font-size: 150%;}.methods .function { margin-left: 1cm; border-left: 1px solid #383838;}#functions .function { border-top: 1px solid #404040;}.function .function-name { color: #61AFEF;}.function .function-arg { color: #D19A66;}.function .default-str { color: #98C379;}</style>  </head>  <body onresize="arrange()" onload="arrange()">   <!--Navigation Bar-->   <div id="nav"><h2>Contents</h2><ul id="nav-ul">   <li class="nav-li"><a href="#functions">functions</a> <ul class="subnav-ul"><li class="subnav-li"><a href="#B_field">B_field</a></li><li class="subnav-li"><a href="#E_field">E_field</a></li><li class="subnav-li"><a href="#close">close</a></li><li class="subnav-li"><a href="#convert_DAT">convert_DAT</a></li><li class="subnav-li"><a href="#convert_DAT_crawl">convert_DAT_crawl</a></li><li class="subnav-li"><a href="#drop_template">drop_template</a></li><li class="subnav-li"><a href="#ion">ion</a></li><li class="subnav-li"><a href="#load_template">load_template</a></li><li class="subnav-li"><a href="#optimize_phasing">optimize_phasing</a></li><li class="subnav-li"><a href="#phasors_to_magnitudes">phasors_to_magnitudes</a></li><li class="subnav-li"><a href="#plot_Bmax">plot_Bmax</a></li><li class="subnav-li"><a href="#plot_Emax">plot_Emax</a></li><li class="subnav-li"><a href="#plot_groups">plot_groups</a></li><li class="subnav-li"><a href="#plot_groups_at_ROW">plot_groups_at_ROW</a></li><li class="subnav-li"><a href="#plot_max_fields">plot_max_fields</a></li><li class="subnav-li"><a href="#plot_xs">plot_xs</a></li><li class="subnav-li"><a href="#read_DAT">read_DAT</a></li><li class="subnav-li"><a href="#run">run</a></li><li class="subnav-li"><a href="#show">show</a></li><li class="subnav-li"><a href="#target_fields">target_fields</a></li><li class="subnav-li"><a href="#to_FLD">to_FLD</a></li><li class="subnav-li"><a href="#to_FLDs">to_FLDs</a></li><li class="subnav-li"><a href="#to_FLDs_crawl">to_FLDs_crawl</a></li></ul>   <li class="nav-li"><a href="#classes">classes</a> <ul class="subnav-ul"><li class="subnav-li"><a href="#Conductor">Conductor</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#Conductor-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Conductor-d_bund>d_bund</a></li><li class="subsubsubnav-li"><a href=#Conductor-subconds>subconds</a></li><li class="subsubsubnav-li"><a href=#Conductor-I>I</a></li><li class="subsubsubnav-li"><a href=#Conductor-phase>phase</a></li><li class="subsubsubnav-li"><a href=#Conductor-tag>tag</a></li><li class="subsubsubnav-li"><a href=#Conductor-d_cond>d_cond</a></li><li class="subsubsubnav-li"><a href=#Conductor-V>V</a></li><li class="subsubsubnav-li"><a href=#Conductor-y>y</a></li><li class="subsubsubnav-li"><a href=#Conductor-x>x</a></li><li class="subsubsubnav-li"><a href=#Conductor-freq>freq</a></li><li class="subsubsubnav-li"><a href=#Conductor-complete>complete</a></li></ul></li><li class="subsubnav-li"><a href=#Conductor-methods>methods</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Conductor-copy>copy</a></li></ul></li></ul></li><li class="subnav-li"><a href="#CrossSection">CrossSection</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#CrossSection-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#CrossSection-d_bund>d_bund</a></li><li class="subsubsubnav-li"><a href=#CrossSection-max_dist>max_dist</a></li><li class="subsubsubnav-li"><a href=#CrossSection-y_sample>y_sample</a></li><li class="subsubsubnav-li"><a href=#CrossSection-tag>tag</a></li><li class="subsubsubnav-li"><a href=#CrossSection-freq>freq</a></li><li class="subsubsubnav-li"><a href=#CrossSection-sheet>sheet</a></li><li class="subsubsubnav-li"><a href=#CrossSection-subconds>subconds</a></li><li class="subsubsubnav-li"><a href=#CrossSection-title>title</a></li><li class="subsubsubnav-li"><a href=#CrossSection-hot>hot</a></li><li class="subsubsubnav-li"><a href=#CrossSection-lROW>lROW</a></li><li class="subsubsubnav-li"><a href=#CrossSection-ROW_edge_fields>ROW_edge_fields</a></li><li class="subsubsubnav-li"><a href=#CrossSection-complete>complete</a></li><li class="subsubsubnav-li"><a href=#CrossSection-conds>conds</a></li><li class="subsubsubnav-li"><a href=#CrossSection-tags>tags</a></li><li class="subsubsubnav-li"><a href=#CrossSection-I>I</a></li><li class="subsubsubnav-li"><a href=#CrossSection-step>step</a></li><li class="subsubsubnav-li"><a href=#CrossSection-sample_height>sample_height</a></li><li class="subsubsubnav-li"><a href=#CrossSection-V>V</a></li><li class="subsubsubnav-li"><a href=#CrossSection-phase>phase</a></li><li class="subsubsubnav-li"><a href=#CrossSection-rROW>rROW</a></li><li class="subsubsubnav-li"><a href=#CrossSection-d_cond>d_cond</a></li><li class="subsubsubnav-li"><a href=#CrossSection-x_sample>x_sample</a></li><li class="subsubsubnav-li"><a href=#CrossSection-i>i</a></li><li class="subsubsubnav-li"><a href=#CrossSection-fields>fields</a></li><li class="subsubsubnav-li"><a href=#CrossSection-gnd>gnd</a></li><li class="subsubsubnav-li"><a href=#CrossSection-y>y</a></li><li class="subsubsubnav-li"><a href=#CrossSection-x>x</a></li></ul></li><li class="subsubnav-li"><a href=#CrossSection-methods>methods</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#CrossSection-remove_conductor>remove_conductor</a></li><li class="subsubsubnav-li"><a href=#CrossSection-compare_DAT>compare_DAT</a></li><li class="subsubsubnav-li"><a href=#CrossSection-sample>sample</a></li><li class="subsubsubnav-li"><a href=#CrossSection-export>export</a></li><li class="subsubsubnav-li"><a href=#CrossSection-copy>copy</a></li><li class="subsubsubnav-li"><a href=#CrossSection-add_conductor>add_conductor</a></li></ul></li></ul></li><li class="subnav-li"><a href="#SectionBook">SectionBook</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#SectionBook-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#SectionBook-xss>xss</a></li><li class="subsubsubnav-li"><a href=#SectionBook-complete>complete</a></li><li class="subsubsubnav-li"><a href=#SectionBook-tags>tags</a></li><li class="subsubsubnav-li"><a href=#SectionBook-i>i</a></li><li class="subsubsubnav-li"><a href=#SectionBook-name>name</a></li><li class="subsubsubnav-li"><a href=#SectionBook-titles>titles</a></li><li class="subsubsubnav-li"><a href=#SectionBook-sheets>sheets</a></li><li class="subsubsubnav-li"><a href=#SectionBook-tag_groups>tag_groups</a></li><li class="subsubsubnav-li"><a href=#SectionBook-ROW_edge_max>ROW_edge_max</a></li></ul></li><li class="subsubnav-li"><a href=#SectionBook-methods>methods</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#SectionBook-results_export>results_export</a></li><li class="subsubsubnav-li"><a href=#SectionBook-ROW_edge_export>ROW_edge_export</a></li><li class="subsubsubnav-li"><a href=#SectionBook-sample>sample</a></li><li class="subsubsubnav-li"><a href=#SectionBook-export>export</a></li><li class="subsubsubnav-li"><a href=#SectionBook-remove_section>remove_section</a></li><li class="subsubsubnav-li"><a href=#SectionBook-add_section>add_section</a></li></ul></li></ul></li></ul></ul></div>   <div id="main">    <h1>emf.fields</h1>    <!--classes section-->    <div class="section" id="classes"><h2>Classes</h2><div class="class" id="Conductor"><h3>Conductor</h3><p class="docstr">A single power line object representing an infintely long conductor and storing basic physical parameters like the line's 2D coordinates, size, voltage, current, phase angle, etc. The Conductor class is the functional unit of emf.fields. Groups of Conductors are organized by higher level CrossSection objects to form complete 2D EMF models of parellel sets of power lines. CrossSection objects use the physical parameters stored in Conductor objects to compute predicted EMF values at a fixed height across a preset distance perpendicular to the power lines.</p><div class="function" ><p class="function-str"><span class="function-name">Conductor</span>(*<span class="function-arg">args</span>)</p><p class="docstr">args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tag - scalar hashable, mandatory, essentially just a name<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;params - dict or list, available Conductor parameters are:<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x, y, subconds, d_cond, d_bund, V, I, phase<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;A list can be passed with the values of any number of the above<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;paremeters (in the order listed above) or a dict can be passed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;with any number of those parameter strings as keys.<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;cond - an existing Conductor object, parameters that are not set<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;with the second arg will be borrowed from the Conductor</p></div><div class="properties" id="Conductor-properties"><h4>Properties</h4><div class="property" id="Conductor-I"><p class="property-name">I</p><p class="docstr">Conductor phase current, not line current (Amps)</p></div><div class="property" id="Conductor-V"><p class="property-name">V</p><p class="docstr">Conductor phase voltage, not line voltage (Volts)</p></div><div class="property" id="Conductor-complete"><p class="property-name">complete</p><p class="docstr">Check if all Conductor variables have been set<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;b - bool, True if all physical parameters are not None<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;v - name of first unset parameter or None</p></div><div class="property" id="Conductor-d_bund"><p class="property-name">d_bund</p><p class="docstr">Diameter of the conductor bundle, defaults to d_cond if subconds == 1 (inches)</p></div><div class="property" id="Conductor-d_cond"><p class="property-name">d_cond</p><p class="docstr">Diameter of the conductor or a single subconductor if subconds > 1 (inches)</p></div><div class="property" id="Conductor-freq"><p class="property-name">freq</p><p class="docstr">Conductor frequency (Hz), cannot be set because Conductors in the same CrossSection are assumed to have equal frequencies, making the frequency irrelevant. This is a stand in value that does not currently affect EMF calculations in any way.</p></div><div class="property" id="Conductor-phase"><p class="property-name">phase</p><p class="docstr">Conductor phase angle (degrees)</p></div><div class="property" id="Conductor-subconds"><p class="property-name">subconds</p><p class="docstr">The number of subconductors in the conductor "bundle," defaults to 1 if left unset</p></div><div class="property" id="Conductor-tag"><p class="property-name">tag</p><p class="docstr">Conductor object identification, usually a string but can be anything hashable</p></div><div class="property" id="Conductor-x"><p class="property-name">x</p><p class="docstr">Conductor x coordinate (ft)</p></div><div class="property" id="Conductor-y"><p class="property-name">y</p><p class="docstr">Conductor y coordinate (ft)</p></div></div><div class="methods" id="Conductor-methods"><h4>Methods</h4><div class="function" id=Conductor-copy><p class="function-str"><span class="function-name">copy</span>()</p><p class="docstr">Return a deep copy of the Conductor object</p></div></div></div><div class="class" id="CrossSection"><h3>CrossSection</h3><p class="docstr">An object representing a single model of a set of parellel power lines. CrossSections are containers for Conductor objects, providing dict-like access to the Conductors by their 'tag' properties, which also store modeling information like the sampling locations and the horizontal locations of right-of-way (ROW) edges, which usually mark the edge of the utility company's property and the location of regulatory interest. CrossSections use the physical parameters stored in Conductor objects to compute predicted EMF values.</p><div class="function" ><p class="function-str"><span class="function-name">CrossSection</span>(<span class="function-arg">sheet</span>, *<span class="function-arg">args</span>)</p><p class="docstr">CrossSection must be initialized with a sheet string, and a list of Conductor objects can optionally be passed in in the second arg<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - string, the name of the CrossSection<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;conds - optional list of Conducor objects to copy into the xs</p></div><div class="properties" id="CrossSection-properties"><h4>Properties</h4><div class="property" id="CrossSection-I"><p class="property-name">I</p><p class="docstr">Generate an array of Conductor currents (Amps), in the same order as 'conds'</p></div><div class="property" id="CrossSection-ROW_edge_fields"><p class="property-name">ROW_edge_fields</p><p class="docstr">Slice the 'fields' DataFrame and return another DataFrame with only the results at the left and right right-of-way (ROW) edges, the locations of which are set in 'lROW' and 'rROW'.</p></div><div class="property" id="CrossSection-V"><p class="property-name">V</p><p class="docstr">Generate an array of Conductor voltages (Volts), in the same order as 'conds'</p></div><div class="property" id="CrossSection-complete"><p class="property-name">complete</p><p class="docstr">Check that all variables in each conductor in the CrossSection are set, and not left with the initial None values.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;b - True if all Conductors are complete, False if not<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;t - tag of first incomplete Conductor, if any, else None<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;v - variable name of first unset variable in first incomplete Conductor, if any, else None</p></div><div class="property" id="CrossSection-conds"><p class="property-name">conds</p><p class="docstr">List of Conductor objects added to the CrossSection. Do not modify it directly, but use the CrossSection methods add_conductor() and remove_conductor() to manage which Conductor objects are in a CrossSection.</p></div><div class="property" id="CrossSection-d_bund"><p class="property-name">d_bund</p><p class="docstr">Generate an array of Conductor bundle diameters (inches, see Conductor.d_bund), in the same order as 'conds'</p></div><div class="property" id="CrossSection-d_cond"><p class="property-name">d_cond</p><p class="docstr">Generate an array of Conductor diameters (inches, see Conductor.d_cond), in the same order as 'conds'</p></div><div class="property" id="CrossSection-fields"><p class="property-name">fields</p><p class="docstr">A pandas DataFrame of magnetic and electric field results at the points defined by 'x_sample' and 'y_sample'. The results are calculated and stored upon the first reference to this property. If Conductor objects in the CrossSection are modified in relevant ways, the results are cleared and recalculated when 'fields' is next accessed. All updating/refreshing is done automatically. The DataFrame of results is indexed by the values in 'x_sample' and has the following columns 'Ex', 'Ey', 'Eprod', 'Emax', 'Bx', 'By', 'Bprod', and 'Bmax.' The columns correspond to different components of the electric and magnetic fields (see emf.fields.phasors_to_magnitudes()). The electric fields are reported in units of kV/m and the magnetic fields are reported in units of mG (milliGauss).</p></div><div class="property" id="CrossSection-freq"><p class="property-name">freq</p><p class="docstr">Generate an array of Conductor frequencies, in the same order as 'conds'</p></div><div class="property" id="CrossSection-gnd"><p class="property-name">gnd</p><p class="docstr">Return a list of the grounded (zero Voltage) Conductor objects in the CrossSection</p></div><div class="property" id="CrossSection-hot"><p class="property-name">hot</p><p class="docstr">Return a list of the hot (nonzero Voltage) Conductor objects in the CrossSection</p></div><div class="property" id="CrossSection-i"><p class="property-name">i</p><p class="docstr">Use CrossSection.i[] to retrieve Conductor objects by the integer order in which they were added to the CrossSection. For example, CrossSection.i[0] gets the first Conductor added, CrossSection.i[4] gets the fifth one added, etc.</p></div><div class="property" id="CrossSection-lROW"><p class="property-name">lROW</p><p class="docstr">Horizontal location of the left (negative x) edge of the right-of-way (ROW), a point of interest on the left side of the model (ft)</p></div><div class="property" id="CrossSection-max_dist"><p class="property-name">max_dist</p><p class="docstr">Maximum horizontal distance of sample points for EMF calculations (ft), default is 100. Resolution is controlled by the 'step' property.</p></div><div class="property" id="CrossSection-phase"><p class="property-name">phase</p><p class="docstr">Generate an array of Conductor phase angles (degrees), in the same order as 'conds'</p></div><div class="property" id="CrossSection-rROW"><p class="property-name">rROW</p><p class="docstr">Horizontal location of the right (positive x) edge of the right-of-way (ROW), a point of interest on the left side of the model (ft)</p></div><div class="property" id="CrossSection-sample_height"><p class="property-name">sample_height</p><p class="docstr">Height of all sample points (ft), default is 3</p></div><div class="property" id="CrossSection-sheet"><p class="property-name">sheet</p><p class="docstr">The principle identification variable of a CrossSection, should be a string briefly identifying the object. CrossSections are retrieved from SectionBook objects by their sheet strings.</p></div><div class="property" id="CrossSection-step"><p class="property-name">step</p><p class="docstr">Horizontal distance between sample points for EMF calculations (ft), default is 1</p></div><div class="property" id="CrossSection-subconds"><p class="property-name">subconds</p><p class="docstr">Generate an array of Conductor subconductor counts (see Conductor.subconds), in the same order as 'conds'</p></div><div class="property" id="CrossSection-tag"><p class="property-name">tag</p><p class="docstr">Very short variable used to group CrossSections in SectionBooks. CrossSection objects in SectionBooks that have the same tag properties are grouped for functions that involve comparisons.</p></div><div class="property" id="CrossSection-tags"><p class="property-name">tags</p><p class="docstr">Return a list of the tags of Conductors in the CrossSection, in the order in which the Conductors were added</p></div><div class="property" id="CrossSection-title"><p class="property-name">title</p><p class="docstr">Longer form identification string, used in plot titles and such</p></div><div class="property" id="CrossSection-x"><p class="property-name">x</p><p class="docstr">Generate an array of Conductor x coordinates (ft), in the same order as 'conds'</p></div><div class="property" id="CrossSection-x_sample"><p class="property-name">x_sample</p><p class="docstr">Compute an array of horizontal coordinates (ft) for EMF calculations, based on 'max_dist' and 'step'. The left and right ROW edge locations ('lROW' and 'rROW') are always included in the returned array.</p></div><div class="property" id="CrossSection-y"><p class="property-name">y</p><p class="docstr">Generate an array of Conductor y coordinate (ft)s, in the same order as 'conds'</p></div><div class="property" id="CrossSection-y_sample"><p class="property-name">y_sample</p><p class="docstr">Return an array the same length as 'x_sample' with all values equal to 'sample_height'</p></div></div><div class="methods" id="CrossSection-methods"><h4>Methods</h4><div class="function" id=CrossSection-add_conductor><p class="function-str"><span class="function-name">add_conductor</span>(<span class="function-arg">cond</span>)</p><p class="docstr">Add a copy of a Conductor object to the CrossSection, which can be accessed by indexing the CrossSection like a dictionary, using the Conductor's 'tag' attribute.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;cond - Conductor object to add</p></div><div class="function" id=CrossSection-compare_DAT><p class="function-str"><span class="function-name">compare_DAT</span>(<span class="function-arg">DAT_path</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Load a FIELDS output file (.DAT) to calculate absolute and percentage differences between it and the CrossSection object's results. The results in the DAT file must be sampled at the same x coordinates as those in the CrossSection. A panel of comparison results is returned. If the 'save' or 'path' keywords are used, the comparison results will be saved with plots demonstrating the comparisons.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;DAT_path - path of FIELDS results file<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle whether output Panel and figures are saved,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;also saves figures with error and comparison plots<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination of saved files, will force save == True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;round - int, round the results in self.fields to a certain number<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of digits in an attempt to exactly match the FIELDS results, which are printed only to the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;thousandths digit<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;truncate - bool, truncate results after the thousandths digit<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;pan - pandas Panel with DAT results, results of this code,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the absolute error between, and the relative error between</p></div><div class="function" id=CrossSection-copy><p class="function-str"><span class="function-name">copy</span>()</p><p class="docstr">Return a deep copy of the CrossSection object</p></div><div class="function" id=CrossSection-export><p class="function-str"><span class="function-name">export</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">Write the 'fields' DataFrame to a csv<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved file</p></div><div class="function" id=CrossSection-remove_conductor><p class="function-str"><span class="function-name">remove_conductor</span>(<span class="function-arg">key</span>)</p><p class="docstr">Remove a Conductor object from the CrossSection<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;key - Conductor tag or Conductor object to remove</p></div><div class="function" id=CrossSection-sample><p class="function-str"><span class="function-name">sample</span>(*<span class="function-arg">args</span>)</p><p class="docstr">Get a random Conductor  or a list of random Conductors from the CrossSection<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;an input integer determines the number of random xss fetched,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;which might not be unique</p></div></div></div><div class="class" id="SectionBook"><h3>SectionBook</h3><p class="docstr">A top level class organizing a group of CrossSection objects. It provides dict-like access to child CrossSection objects by their 'sheet' properties. It also maintains a table of maximum field results at the ROW edges of each CrossSection added (the ROW_edge_max property), provides exporting methods, and can be passed to plotting functions to generate plots comparing groups of CrossSections. CrossSections in a SectionBook are grouped by their 'tag' properties. Those with identical tags are automatically grouped.</p><div class="function" ><p class="function-str"><span class="function-name">SectionBook</span>(<span class="function-arg">name</span>, *<span class="function-arg">args</span>)</p><p class="docstr">SectionBooks must be initialized with a name string, with the option to pass a list of CrossSection objects in the second arg that will be copied into the new object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;name - string, name of SectionBook<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - list of CrossSection objects to copy into the SectionBook</p></div><div class="properties" id="SectionBook-properties"><h4>Properties</h4><div class="property" id="SectionBook-ROW_edge_max"><p class="property-name">ROW_edge_max</p><p class="docstr">DataFrame with maximum field magnitudes at the right-of-way (ROW) edges of each CrossSection in the SectionBook. The DataFrame is indexed by the CrossSection sheet strings, and has columns 'Bmaxl', 'Bmaxr', 'Emaxl', 'Emaxr'.</p></div><div class="property" id="SectionBook-complete"><p class="property-name">complete</p><p class="docstr">Check that all CrossSections in the SectionBook are complete<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;b - True if all xcs are complete, False if not<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - sheet of first incomplete xs, if any, else None<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ctag - tag of first incomplete Conductor in first incomplete xs,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if any, else None<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;v - variable name of first unset variable in first incomplete<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Conductor in first incomplete xs, if any, else None</p></div><div class="property" id="SectionBook-i"><p class="property-name">i</p><p class="docstr">Use SectionBook.i[] to retrieve CrossSection objects by the integer order in which they were added to the SectionBook. For example, SectionBook.i[0] gets the first CrossSection added, SectionBook.i[4] gets the fifth one added, etc.</p></div><div class="property" id="SectionBook-name"><p class="property-name">name</p><p class="docstr">Mandatory string identifying the SectionBook object</p></div><div class="property" id="SectionBook-sheets"><p class="property-name">sheets</p><p class="docstr">A list of CrossSection sheet strings, in the same order as 'xss'</p></div><div class="property" id="SectionBook-tag_groups"><p class="property-name">tag_groups</p><p class="docstr">A list of lists of grouped CrossSection objects</p></div><div class="property" id="SectionBook-tags"><p class="property-name">tags</p><p class="docstr">A set of unique CrossSection tags</p></div><div class="property" id="SectionBook-titles"><p class="property-name">titles</p><p class="docstr">A list of CrossSection titles, in the same order as 'xss'</p></div><div class="property" id="SectionBook-xss"><p class="property-name">xss</p><p class="docstr">List of CrossSection objects added to the SectionBook. Should not be edited directly, but with SectionBook.add_section() and SectionBook.remove_section().</p></div></div><div class="methods" id="SectionBook-methods"><h4>Methods</h4><div class="function" id=SectionBook-ROW_edge_export><p class="function-str"><span class="function-name">ROW_edge_export</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">Write max field results at ROW edges for each cross section to an excel or csv file. Default is csv.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;file_type - string, accepts 'csv' or 'excel' (default csv)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved file<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xl - pandas ExcelWriter object, takes precedence over 'path'</p></div><div class="function" id=SectionBook-add_section><p class="function-str"><span class="function-name">add_section</span>(<span class="function-arg">xs</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Copy a CrossSection into the SectionBook. Use this method instead of directly editing the 'xss' list.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - CrossSection object to add to SectionBook (a copy is added)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - a new sheet name for the added CrossSection</p></div><div class="function" id=SectionBook-export><p class="function-str"><span class="function-name">export</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">Write complete sets of model results to an excel workbook with each CrossSection's 'fields' DataFrame in a separate sheet. Also write the ROW_edge_max DataFrame to a csv.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved file</p></div><div class="function" id=SectionBook-remove_section><p class="function-str"><span class="function-name">remove_section</span>(<span class="function-arg">sheet</span>)</p><p class="docstr">Remove a CrossSection from the SectionBook by providing its sheet string<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - sheet string of CrossSection to remove</p></div><div class="function" id=SectionBook-results_export><p class="function-str"><span class="function-name">results_export</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">Write all of the cross section results to an excel workbook with each CrossSection's 'fields' DataFrame in a separate sheet.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved file</p></div><div class="function" id=SectionBook-sample><p class="function-str"><span class="function-name">sample</span>(*<span class="function-arg">args</span>)</p><p class="docstr">Get a random CrossSection from the SectionBook or a list of random CrossSection objects<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;an input integer determines the number of random CrossSections returned in a list, which may not be unique</p></div></div></div></div>    <!--functions section-->    <div class="section" id="functions"><h2>Functions</h2><div class="function" id="B_field"><p class="function-str"><span class="function-name">B_field</span>(<span class="function-arg">x_cond</span>, <span class="function-arg">y_cond</span>, <span class="function-arg">I_cond</span>, <span class="function-arg">p_cond</span>, <span class="function-arg">x</span>, <span class="function-arg">y</span>)</p><p class="docstr">Calculate the approximate magnetic field generated by a group of conductors. Each of the variables with '_cond' should be an numpy array of parameters, where each index in those arrays describes a unique conductor, i.e. the 0th value in each variable is attributed to one power line.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_cond - 1D numpy array, horizontal coordinates of conductors (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y_cond - 1D numpy array, vertical coordinates of conductors (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;I_cond - 1D numpy array, currents of conductors (Amps)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;p_cond - 1D numpy array, phases of conductors (degrees)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - iterable of floats, horizontal coordinates of sample points (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - iterable of floats, vertical coordinates of sample points (ft)<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Bx - 1D numpy array of complex numbers, magnitic field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the horizontal direction (mG)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;By - 1D numpy array of complex numbers, magnitic field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the vertical direction (mG)</p></div><div class="function" id="E_field"><p class="function-str"><span class="function-name">E_field</span>(<span class="function-arg">x_cond</span>, <span class="function-arg">y_cond</span>, <span class="function-arg">subconds</span>, <span class="function-arg">d_cond</span>, <span class="function-arg">d_bund</span>, <span class="function-arg">V_cond</span>, <span class="function-arg">p_cond</span>, <span class="function-arg">x</span>, <span class="function-arg">y</span>)</p><p class="docstr">Calculate the approximate electric field generated by a group of conductors. Each of the inputs with '_cond' in their name should be an numpy array of parameters, where each index in those arrays describes a unique conductor, i.e. the 0th value in each variable is attributed to one power line.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_cond - 1D numpy array, horizontal coordinates of conductors (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y_cond - 1D numpy array, vertical coordinates of conductors (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;subconds - 1D numpy array, number of subconductors per bundle<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;d_cond - 1D numpy array, conductor diameters (inches)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;d_bund - 1D numpy array, bundle diameters (inches)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;V_cond - 1D numpy array, voltages of conductors (Amps)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;p_cond - 1D numpy array, phases of conductors (degrees)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - iterable of floats, horizontal coordinates of sample points (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - iterable of floats, vertical coordinates of sample points (ft)<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ex - 1D numpy array of complex numbers, electric field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the horizontal direction (kV/m)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ey - 1D numpy array of complex numbers, electric field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the vertical direction (kV/m)</p></div><div class="function" id="close"><p class="function-str"><span class="function-name">close</span>(*<span class="function-arg">args</span>)</p><p class="docstr">Call plt.close() on any Figure objects or lists of Figure objects passed in. If nothing is passed, all Figure objects are closed with plt.close('all')</p></div><div class="function" id="convert_DAT"><p class="function-str"><span class="function-name">convert_DAT</span>(<span class="function-arg">file_path</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">read a DAT file and write it to a csv<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;file_path - target DAT file<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - output location/name for csv file</p></div><div class="function" id="convert_DAT_crawl"><p class="function-str"><span class="function-name">convert_DAT_crawl</span>(<span class="function-arg">dir_name</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">crawl a directory and all of its subdirectories for .DAT files that can be passed to DAT_to_csv() for output re-formatting and optional plotting.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;dir_name - Directory to initiate the crawl in.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;To designate the current directory, use '*'<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;bundle - bool, if True, all DAT files found in the same directory<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;are written to a common excel workbook. If False or absent,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the DAT files are simply written to individual csv files.</p></div><div class="function" id="drop_template"><p class="function-str"><span class="function-name">drop_template</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Copy the emf.fields template in the current directory or a directory specified by an input string<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;drop_path - string, path of copied template file</p></div><div class="function" id="ion"><p class="function-str"><span class="function-name">ion</span>()</p><p class="docstr">Call plt.ion() to toggle interactive plotting on</p></div><div class="function" id="load_template"><p class="function-str"><span class="function-name">load_template</span>(<span class="function-arg">file_path</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Import conductor data from an excel template, loading each conductor into a Conductor object, each Conductor into a CrossSection object, and each CrossSection object into a SectionBook object. The SectionBook object is returned.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;template_path - string, path to cross section template excel<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;workbook<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheets - list of strings, a list of sheet names to load, default is<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;all sheets</p></div><div class="function" id="optimize_phasing"><p class="function-str"><span class="function-name">optimize_phasing</span>(<span class="function-arg">xs</span>, <span class="function-arg">circuits</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Permute the phasing of non-grounded conductors and find the arrangement that results in the lowest fields at the left and right edge of the ROW. The number of hot conductors must be a multiple of three. The phases of consecutive groups of three conductors are swapped around, assuming that those groups represent a single three-phase transfer circuit.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - target CrossSection object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;circuits - list of lists of Conductor tags, or 'all'. If a list of<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;lists, each sublist contains the Conductor tags of the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Conductors comprising a single circuit. If 'all',<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;circuits are assumed to be consecutive groups of three<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;conductors. (consecutive according to the order in which<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;hot conductors were added to the CrossSection)<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle saving of the results DataFrame to an excel book<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, location/filename for saved results workbook,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;forces saving even if no 'save' keyword is used.<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;res - pandas DataFrame listing conductor phasings that optimize<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;electric and magnetic fields at both ROW edges.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;opt - new SectionBook object containing the permuted phasings that<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optimize the E and B fields at the left and right ROW edges.</p></div><div class="function" id="phasors_to_magnitudes"><p class="function-str"><span class="function-name">phasors_to_magnitudes</span>(<span class="function-arg">Ph_x</span>, <span class="function-arg">Ph_y</span>)</p><p class="docstr">Convert vectors of complex x and y phasors into real quantities, namely the amplitude of the field in the x and y directions, the product (the hypotenuse of the amplitudes), and the maximum field. Results of E_field and B_field can be passed directly to this function for conversion from phasor form into usable form.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_x - complex 1D numpy array, phasor horizontal components<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_y - complex 1D numpy array, phasor vertical components<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;mag_x - 1D numpy array, maximum horizontal field<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;mag_y - 1D numpy array, maximum vertical field<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;prod - 1D numpy array, sqrt(mag_x**2 + mag_y**2)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;maximum - 1D numpy array, maximum field at any time</p></div><div class="function" id="plot_Bmax"><p class="function-str"><span class="function-name">plot_Bmax</span>(<span class="function-arg">xs</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Plot the maximum magnetic field along the ROW with conductor locations shown in artificial coordinates.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - a CrossSection object<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - Axes object</p></div><div class="function" id="plot_Emax"><p class="function-str"><span class="function-name">plot_Emax</span>(<span class="function-arg">xs</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Plot the maximum electric field along the ROW with conductor locations shown in artificial coordinates.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - a CrossSection object<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object</p></div><div class="function" id="plot_groups"><p class="function-str"><span class="function-name">plot_groups</span>(<span class="function-arg">sb</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Plot the fields of grouped CrossSections in the same axis, a plot for both fields. Only plots groups of more than one CrossSection.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sb - SectionBook object to pull plotting groups from<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xmax - cutoff distance from ROW center<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B - bool, toggle magnetic field plots, default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;E - bool, toggle electric field plots, default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;groups - a list of group names to plot, default is all groups<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;return_figs - toggle whether a list of figure objects is returned<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;instead of closing the figures to clear memory,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is False<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;figs - dict of dicts, keys are 'E' and 'B', which are each keyed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;by group tags, leading to Figure objects</p></div><div class="function" id="plot_groups_at_ROW"><p class="function-str"><span class="function-name">plot_groups_at_ROW</span>(<span class="function-arg">sb</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Create bar charts showing the field values at ROW edges for each CrossSection group in a SectionBook<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sb - SectionBook object to pull plotting groups from<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B - bool, toggle magnetic field plots, default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;E - bool, toggle electric field plots, default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;groups - a list of group names to plot, default is all groups<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs_order - dict, keys are CrossSection group tags, which map to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;lists of CrossSection sheets specifying the order of the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;plotted CrossSection bars (left to right). Not all<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;CrossSections in a group must be listed.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Any/all can be left out.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;return_figs - toggle whether a list of figure objects is returned<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;instead of closing the figures to clear memory,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is False<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;figs - dict of dicts, keys are 'E' and 'B', which are each keyed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;by group tags, leading to Figure objects</p></div><div class="function" id="plot_max_fields"><p class="function-str"><span class="function-name">plot_max_fields</span>(<span class="function-arg">xs</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Plot the maximum magnetic and electric field on split vertical axes, along the ROW with conductor locations shown in artificial coordinates.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - a CrossSection object<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;title - string, exact plot title<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax_B - B field Axes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax_E - E field Axes</p></div><div class="function" id="plot_xs"><p class="function-str"><span class="function-name">plot_xs</span>(<span class="function-arg">xs</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Plot CrossSection conductors and ROW edges without any fields<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - CrossSection objects<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle plot saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')</p></div><div class="function" id="read_DAT"><p class="function-str"><span class="function-name">read_DAT</span>(<span class="function-arg">file_path</span>)</p><p class="docstr">Read a DAT file, which can have some funky extra characters if the numbers are too large (percent signs)<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;file_path - string, path to DAT file<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;pandas DataFrame with 'Bx','By','Bprod','Bmax','Ex','Ey','Eprod',<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;and 'Emax' columns, and the distance ('x') in the index</p></div><div class="function" id="run"><p class="function-str"><span class="function-name">run</span>(<span class="function-arg">template_path</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Import the templates in an excel file with the path 'template_path' then generate a workbook of all fields results and lots of plots. Use the 'path' keyword argument to specify a destination for the output, otherwise it will be saved to the template's directory. Returns a SectionBook object.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;template_path - path to cross section template excel workbook<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheets - a list of sheet names to load, default is all sheets<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, destination/filename for saved files<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format (usually 'png' or 'pdf')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xmax - cutoff distance from ROW center in plots</p></div><div class="function" id="show"><p class="function-str"><span class="function-name">show</span>()</p><p class="docstr">Call plt.show() to display open figures</p></div><div class="function" id="target_fields"><p class="function-str"><span class="function-name">target_fields</span>(<span class="function-arg">xs</span>, <span class="function-arg">tags</span>, <span class="function-arg">B_l</span>, <span class="function-arg">B_r</span>, <span class="function-arg">E_l</span>, <span class="function-arg">E_r</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Increase conductor y coordinates until fields at ROW edges are below thresholds. All selected conductors are adjusted by the same amount. If any of the thresholds are empty or false, None is returned for their adjustment result.<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - CrossSection object to perform adjustments on<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tags - iterable of Conductor tags, identifying which ones to raise<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B_l - magnetic field threshold at left ROW edge*<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B_r - magnetic field threshold at right ROW edge*<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;E_l - electric field threshold at left ROW edge*<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;E_r - electric field threshold at right ROW edge*<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;*an implicitly False input will ignore that field-edge<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;combination, return None in the return variable 'h', and cause<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the returned SectionBook to omit that field-edge combo.<br><br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_iter - maximum number of _bisection iterations allowed,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is 1e3<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;rel_err - tolerance threshold for relative error (e.g. 0.01 is 1 %),<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is 1e-6.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;hhigh - upper limit of the height adjustment, default is 1.0e6<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - toggle saving of the results DataFrame to an excel book<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - location/filename for saved results workbook, forces saving<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;even if no 'save' keyword is used.<br>&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;h - height adjustments necessary for E and B fields at left and<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;right ROW edges. The ordering is: (B_left, B_right, E_left, E_right)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;adj - a new SectionBook object with the adjusted conductor heights<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;for each scenario in a CrossSection</p></div><div class="function" id="to_FLD"><p class="function-str"><span class="function-name">to_FLD</span>(<span class="function-arg">xs</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Create an FLD input file for FIELDS from a CrossSection object<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs - CrossSection object<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - output file destination</p></div><div class="function" id="to_FLDs"><p class="function-str"><span class="function-name">to_FLDs</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Load or recieve a template workbook of CrossSections and convert them all to FLD files<br>&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;can either be a path string to a target template workbook or an<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;existing SectionBook object<br>&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - output destination for FLD files</p></div><div class="function" id="to_FLDs_crawl"><p class="function-str"><span class="function-name">to_FLDs_crawl</span>(<span class="function-arg">dir_name</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">crawl a directory and all of its subdirectories for excel workbooks that can be passed to create_FLDs(). The FLD files are generated in the same directory as the template book they come from.</p></div></div>   </div>  </body>  <!--Control the width and height of the #main element-->  <script type="text/javascript">function arrange(){ var nav = document.getElementById('nav'); var main = document.getElementById('main'); var w_nav = nav.offsetWidth; var w_body = document.body.offsetWidth; var w = (w_body - w_nav - 3).toString() + 'px'; main.style.width = w; var h = main.offsetHeight; nav.style.height = h; console.log('arrange'); };arrange();</script> </html> 